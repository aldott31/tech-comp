<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <template id="techmap_page" name="Albanian Tech Map">
        <t t-call="web.layout">
            <t t-set="head">
                <!-- Leaflet CSS -->
                <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
                    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
                    crossorigin=""/>

                <!-- Custom CSS -->
                <link rel="stylesheet" href="/albanian_tech_map/static/src/css/map.css"/>

                <!-- Leaflet JS -->
                <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
                    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
                    crossorigin=""></script>
            </t>

            <div id="wrap" class="oe_structure">
                <!-- Header -->
                <div class="tech-map-header">
                    <div class="container-fluid">
                        <div class="row align-items-center py-3">
                            <div class="col-md-8">
                                <h1 class="mb-0">
                                    <i class="fa fa-map-marker text-primary"/> Harta e Kompanive IT / Digjitale në Shqipëri
                                </h1>
                                <p class="text-muted mb-0">
                                    <span class="badge badge-info"><t t-esc="company_count"/> kompani</span>
                                    <span class="ml-2 small">Përditësuar automatikisht çdo 24 orë</span>
                                </p>
                            </div>
                            <div class="col-md-4 text-right">
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-sm btn-outline-secondary" id="filter-all">
                                        <i class="fa fa-globe"/> Të gjitha
                                    </button>
                                    <button type="button" class="btn btn-sm btn-outline-info" id="filter-software">
                                        <i class="fa fa-code"/> Software
                                    </button>
                                    <button type="button" class="btn btn-sm btn-outline-success" id="filter-agency">
                                        <i class="fa fa-paint-brush"/> Agjenci
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Map Container -->
                <div class="map-wrapper">
                    <div id="map" class="tech-map-container"></div>

                    <!-- Side Panel (optional, for company list) -->
                    <div id="side-panel" class="tech-map-sidebar">
                        <div class="sidebar-header">
                            <input type="text" id="search-input" class="form-control" placeholder="Kërko kompani..."/>
                        </div>
                        <div class="sidebar-content" id="company-list">
                            <!-- Company list will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Toggle sidebar button -->
                    <button id="toggle-sidebar" class="btn btn-primary btn-sm sidebar-toggle">
                        <i class="fa fa-bars"></i>
                    </button>
                </div>

                <!-- Footer Info -->
                <div class="tech-map-footer">
                    <div class="container-fluid">
                        <div class="row py-2">
                            <div class="col-md-6">
                                <small class="text-muted">
                                    <i class="fa fa-info-circle"/> Të dhënat mbledhhen automatikisht nga biznes.al, niptgov.al dhe burime të tjera
                                </small>
                            </div>
                            <div class="col-md-6 text-right">
                                <small class="text-muted">
                                    <a href="/techmap/api/companies" target="_blank">
                                        <i class="fa fa-code"/> API
                                    </a>
                                    |
                                    <a href="https://github.com/albaniantechmap" target="_blank">
                                        <i class="fa fa-github"/> GitHub
                                    </a>
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pass data to JavaScript -->
            <script type="text/javascript">
                // Configuration
                var TECHMAP_CONFIG = {
                    apiUrl: '/techmap/api/companies',
                    selectedCompanyId: <t t-esc="selected_company_id or 'null'"/>,
                    mapCenter: [41.33, 19.83], // Tirana, Albania
                    mapZoom: 13,
                };
            </script>

            <!-- Load map JavaScript -->
            <script src="/albanian_tech_map/static/src/js/map.js"></script>
        </t>
    </template>

</odoo>
